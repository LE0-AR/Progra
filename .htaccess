# ========================================
# ðŸ”’ SEGURIDAD GLOBAL
# ========================================

# Evita listar el contenido de carpetas
Options -Indexes

RewriteEngine On

# IMPORTANTE: Define la carpeta base de tu proyecto
RewriteBase /DW/Biticarora/app/

# Bloquea acceso directo a archivos sensibles
<FilesMatch "\.(htaccess|env|ini|log|sh|bat|sql)$">
    Require all denied
</FilesMatch>

# ========================================
# ðŸš« BLOQUEO DE CARPETAS SENSIBLES
# ========================================
# 1. ExcepciÃ³n: PERMITIR el script para destruir la sesiÃ³n.
RewriteRule ^Controller/Config/Sesion_destroy\.php$ - [L]

# 2. Ahora sÃ­, REDIRIGIR el resto de las carpetas Config y Server.
RewriteRule ^Controller/(Config|Server) /DW/Biticarora/app/ [R=302,L]

# ========================================
# âœ… REGLAS PARA LA CARPETAS MODEL Y VIEWS
# ========================================
# 1. PERMITIR acceso directo SOLO a las carpetas de recursos pÃºblicos dentro de Model.
RewriteRule ^Model/(js|css|img)/ - [L]

# 2. REDIRIGIR cualquier otro intento de acceso a 'Model' o 'Views/Admin'.
RewriteRule ^Model/ /DW/Biticarora/app/ [R=302,L]


# ========================================
# âœ… PERMISOS DE CARPETAS LIBRES
# ========================================
# Permitir acceso normal a Controller/Ajax y la raÃ­z de Views
RewriteRule ^Controller/Ajax - [L]
RewriteRule ^Views/$ - [L] # Se ajustÃ³ para que solo permita la raÃ­z de Views

# ========================================
# âœ… PERMITIR JS, CSS, IMG, PDF, ETC.
# ========================================
<FilesMatch "\.(js|css|png|jpg|jpeg|gif|webp|svg|pdf|ico)$">
    Require all granted
</FilesMatch>

# ========================================
# ðŸš€ REDIRECCIÃ“N GLOBAL (MVC)
# ========================================
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^ index.php [QSA,L]